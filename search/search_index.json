{"config":{"lang":["en","it"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"ISTAT Cell Data","text":"<p>With ISTAT Cell Data you can easily obtain datasets from ISTAT censuses that include census grid cell data.</p> <p>It is possible to download and process data from 1991 to 2021.</p>"},{"location":"#installation","title":"Installation","text":"<p><code>pip install istatcelldata</code></p> <p>Info</p> <p>This project is not affiliated with or supported by ISTAT and is an independent initiative by Massimiliano Moraca.</p> <p>This repository was created using MkDocs, Material for MkDocs, and mkdocstring.</p>"},{"location":"LICENSE/","title":"License","text":"<p>MIT License</p> <p>Copyright (c) 2023 Massimiliano Moraca</p> <p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p> <p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p> <p>THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>"},{"location":"documentation/data/","title":"Data Module","text":"<p>This module handles non-geographic data.</p>"},{"location":"documentation/data/#istatcelldata.data.preprocess_data","title":"<code>preprocess_data(data_folder, data_column_remapping=None, add_administrative_informations=None, regions_data_path=None, regions_target_columns=None, provinces_data_path=None, provinces_target_columns=None, municipalities_data_path=None, municipalities_target_columns=None, output_folder=None)</code>","text":"<p>Preprocess census CSV files and return aggregated data and trace record.</p> <p>This function performs the following operations:</p> <ol> <li>Searches for all CSV files in the specified folder.</li> <li>Uses the last CSV file (in alphabetical order) as the trace record file.</li> <li>Loads and concatenates all other CSV files into a single DataFrame.</li> <li>Applies column name remapping if <code>data_column_remapping</code> is provided.</li> <li>Adds administrative information (regions, provinces, municipalities) if requested.</li> <li>Replaces any NaN values with 0.</li> <li>Loads the trace record file into a dedicated DataFrame.</li> <li>Returns either:</li> <li>A dictionary containing <code>census_data</code> and <code>trace</code> DataFrames, or</li> <li>Saves the resulting CSV files to <code>output_folder</code> and returns the path.</li> </ol> PARAMETER DESCRIPTION <code>data_folder</code> <p>Folder containing the CSV files to process.</p> <p> TYPE: <code>Path</code> </p> <code>data_column_remapping</code> <p>Optional dictionary for renaming census dataset columns (e.g., <code>{\"pro_com\": \"PRO_COM\"}</code>).</p> <p> TYPE: <code>dict | None</code> DEFAULT: <code>None</code> </p> <code>add_administrative_informations</code> <p>If True, enriches data with administrative information (regions, provinces, municipalities) via <code>add_administrative_info()</code>.</p> <p> TYPE: <code>bool | None</code> DEFAULT: <code>None</code> </p> <code>regions_data_path</code> <p>Optional path to the file containing region data.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> <code>regions_target_columns</code> <p>Optional list of columns to extract/keep for region data.</p> <p> TYPE: <code>list | None</code> DEFAULT: <code>None</code> </p> <code>provinces_data_path</code> <p>Optional path to the file containing province data.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> <code>provinces_target_columns</code> <p>Optional list of columns to extract/keep for province data.</p> <p> TYPE: <code>list | None</code> DEFAULT: <code>None</code> </p> <code>municipalities_data_path</code> <p>Optional path to the file containing municipality data.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> <code>municipalities_target_columns</code> <p>Optional list of columns to extract/keep for municipality data.</p> <p> TYPE: <code>list | None</code> DEFAULT: <code>None</code> </p> <code>output_folder</code> <p>Optional destination folder where the following files will be saved: - <code>census_data.csv</code> for concatenated data - <code>census_trace.csv</code> for the trace record If None, data is returned as a dictionary of DataFrames.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <code>dict | Path</code> <p>Either a dictionary with keys: - <code>\"census_data\"</code>: DataFrame containing concatenated census data - <code>\"trace\"</code>: DataFrame containing field trace record</p> <code>dict | Path</code> <p>Or the path to <code>output_folder</code> if specified, where <code>census_data.csv</code> and</p> <code>dict | Path</code> <p><code>census_trace.csv</code> have been saved.</p> RAISES DESCRIPTION <code>ValueError</code> <p>If no CSV files are found in the specified folder.</p> Note <p>The trace record file is considered to be the last CSV in alphabetical order within <code>data_folder</code>. The <code>check_encoding()</code> function is used to determine the correct encoding for CSV files.</p>"},{"location":"documentation/download/","title":"Download Module","text":"<p>The Download module provides a set of functions to download and manage census data and administrative boundaries. The main functions allow downloading data from specific links, organizing files into folder structures, and handling the automatic extraction and deletion of ZIP files.</p>"},{"location":"documentation/download/#istatcelldata.download.download_base","title":"<code>download_base(data_link, data_file_path_destination, data_folder, destination_folder)</code>","text":"<p>Download a file from URL, display progress bar, and extract the resulting ZIP.</p> <p>This function handles the complete workflow for downloading an archive (typically ZIP format) from an HTTP/HTTPS URL. It saves the file to a local path, displays a progress bar using <code>tqdm</code>, extracts the content to the destination folder, and finally removes the compressed file.</p> PARAMETER DESCRIPTION <code>data_link</code> <p>URL from which to download the file (e.g., census data ZIP archive).</p> <p> TYPE: <code>str</code> </p> <code>data_file_path_destination</code> <p>Complete local path where the downloaded compressed file will be saved.</p> <p> TYPE: <code>Path</code> </p> <code>data_folder</code> <p>Folder where the compressed file content will be extracted.</p> <p> TYPE: <code>Path</code> </p> <code>destination_folder</code> <p>Logical destination folder associated with the downloaded dataset. This path is returned at the end for consistency with the calling workflow.</p> <p> TYPE: <code>Path</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path to <code>destination_folder</code>, usable as a reference to the root of the</p> <code>Path</code> <p>downloaded and extracted data.</p> RAISES DESCRIPTION <code>Exception</code> <p>If the server returns an HTTP status code other than 200, or if any error occurs during download, file saving, or extraction.</p>"},{"location":"documentation/download/#istatcelldata.census1991.download.download_all_census_data_1991","title":"<code>download_all_census_data_1991(output_data_folder, region_list=[])</code>","text":"<p>Download complete census and geographic dataset for the 1991 Census.</p> <p>This function coordinates all necessary operations to obtain census data and geographic information associated with the 1991 Census. It enables downloading of:</p> <ul> <li>Tabular census data</li> <li>Geodata specific to one or more regions</li> <li>Official administrative boundaries</li> </ul> <p>If no value is provided for <code>region_list</code>, geodata for all regions is downloaded.</p> PARAMETER DESCRIPTION <code>output_data_folder</code> <p>Main path where all downloaded and processed data will be saved.</p> <p> TYPE: <code>Path</code> </p> <code>region_list</code> <p>List containing region codes or names for which to download geodata. If empty, all available regions are considered.</p> <p> TYPE: <code>list</code> DEFAULT: <code>[]</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path to the root folder containing the downloaded data.</p> Note <p>This function operates exclusively on the 1991 Census. It uses support functions such as <code>download_data()</code>, <code>download_geodata()</code>, and <code>download_administrative_boundaries()</code>. The necessary folder structure is created automatically.</p>"},{"location":"documentation/download/#istatcelldata.census1991.download.download_data","title":"<code>download_data(output_data_folder, census_year)</code>","text":"<p>Download, organize, and process census data for a specific year.</p> <p>This function manages the complete workflow for acquiring census data from source through to producing final CSV files. The following operations are performed:</p> <ol> <li>Retrieval of the dictionary of links for the census year.</li> <li>Download of raw data via the <code>dwn()</code> function.</li> <li>Creation of the output folder structure.</li> <li>Identification and reading of <code>.xls</code> files.</li> <li>Conversion of Excel files to CSV.</li> <li>Extraction of tracking metadata (codifications) from the first available file.</li> <li>Removal of original Excel files.</li> </ol> PARAMETER DESCRIPTION <code>output_data_folder</code> <p>Root folder path where downloaded data will be saved.</p> <p> TYPE: <code>Path</code> </p> <code>census_year</code> <p>Reference year for the census data to process.</p> <p> TYPE: <code>int</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path to the folder containing the downloaded and processed census data.</p> RAISES DESCRIPTION <code>Exception</code> <p>If no <code>.xls</code> file is found in the data folder.</p> Note <p>Conversion from XLS to CSV is performed via the <code>read_xls()</code> function. Dataset tracking is performed only on the first XLS file found. XLS files are removed at the end of the process to reduce disk space usage.</p>"},{"location":"documentation/download/#istatcelldata.census2001.download.download_all_census_data_2001","title":"<code>download_all_census_data_2001(output_data_folder, region_list=[])</code>","text":"<p>Download complete census and geographic dataset for the 2001 Census.</p> <p>This function coordinates all necessary operations to obtain census data and geographic information associated with the 2001 Census. Specifically, it handles:</p> <ul> <li>Downloading tabular census data</li> <li>Downloading geodata (for all regions or a specified subset)</li> <li>Downloading official administrative boundaries</li> </ul> <p>If <code>region_list</code> is empty, geodata for all available regions is downloaded.</p> PARAMETER DESCRIPTION <code>output_data_folder</code> <p>Main path where all downloaded and processed data will be saved.</p> <p> TYPE: <code>Path</code> </p> <code>region_list</code> <p>List of region codes or names for which to download geodata. If left empty, the function considers all regions.</p> <p> TYPE: <code>list</code> DEFAULT: <code>[]</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path to the root folder <code>output_data_folder</code> containing the 2001 Census</p> <code>Path</code> <p>data structure.</p> Note <p>This function is specific to the 2001 Census (the <code>census_year</code> parameter is fixed internally to 2001). It uses support functions: <code>download_data()</code>, <code>download_geodata()</code>, and <code>download_administrative_boundaries()</code>. A preprocessing subfolder is created automatically, defined by the <code>PREPROCESSING_FOLDER</code> constant.</p>"},{"location":"documentation/download/#istatcelldata.census2011.download.download_administrative_boundaries","title":"<code>download_administrative_boundaries(output_data_folder, census_year)</code>","text":"<p>Download administrative boundaries for a census year and save to data structure.</p> <p>This function retrieves from the census dictionary the URL for administrative boundaries (regions, provinces, municipalities), prepares the folder structure dedicated to the census year, and downloads the associated ZIP file. The content is not extracted: the function only performs the download.</p> PARAMETER DESCRIPTION <code>output_data_folder</code> <p>Main path where the census data structure will be created.</p> <p> TYPE: <code>Path</code> </p> <code>census_year</code> <p>Reference census year (e.g., 1991, 2001, 2011).</p> <p> TYPE: <code>int</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path to the folder containing the downloaded administrative boundaries.</p> RAISES DESCRIPTION <code>Exception</code> <p>If an error occurs during folder creation or download.</p> Note <p>Administrative boundaries include municipalities, provinces, and regions. The file is saved to the folder defined by the <code>BOUNDARIES_DATA_FOLDER</code> constant. The returned path is the census year folder, not the individual downloaded file.</p>"},{"location":"documentation/download/#istatcelldata.census2011.download.download_all_census_data_2011","title":"<code>download_all_census_data_2011(output_data_folder, region_list=[])</code>","text":"<p>Download complete census and geographic dataset for the 2011 Census.</p> <p>This function coordinates the three fundamental operations necessary to obtain all data for the 2011 Population Census:</p> <ol> <li>Download of tabular census data.</li> <li>Download of geodata for one or more regions (or all, if <code>region_list</code> is empty).</li> <li>Download of official administrative boundaries.</li> </ol> <p>In addition to downloading files, the function automatically creates the necessary folder structure within the output directory.</p> PARAMETER DESCRIPTION <code>output_data_folder</code> <p>Main path where all census data will be saved.</p> <p> TYPE: <code>Path</code> </p> <code>region_list</code> <p>List containing region codes or names for which to download geodata. If not provided or empty, the function downloads data for all regions.</p> <p> TYPE: <code>list</code> DEFAULT: <code>[]</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path to the root folder containing the 2011 Census data structure.</p> Note <p>This is a function specific to the 2011 census (the <code>census_year</code> parameter is fixed internally). It uses support functions: <code>download_data()</code>, <code>download_geodata()</code>, and <code>download_administrative_boundaries()</code>. The internal folder used for preprocessing is determined by the <code>PREPROCESSING_FOLDER</code> constant.</p>"},{"location":"documentation/download/#istatcelldata.census2011.download.download_data","title":"<code>download_data(output_data_folder, census_year)</code>","text":"<p>Download census data for a specific year and organize the working folder.</p> <p>This function retrieves from the census dictionary the link to data for the specified year, prepares the destination folder structure, and delegates the actual download to the <code>download_base()</code> function. Upon completion, it returns the path to the downloaded file (or folder, depending on how <code>download_base()</code> is implemented).</p> PARAMETER DESCRIPTION <code>output_data_folder</code> <p>Path to the output folder where the census data structure will be created (e.g., preprocessing folder or project).</p> <p> TYPE: <code>Path</code> </p> <code>census_year</code> <p>Reference year for the census data to download (e.g., 1991, 2001, 2011).</p> <p> TYPE: <code>int</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path returned by <code>download_base()</code>, representing the location of the</p> <code>Path</code> <p>downloaded census data (file or folder).</p> RAISES DESCRIPTION <code>Exception</code> <p>If an error occurs during link retrieval, folder creation, or data download.</p>"},{"location":"documentation/download/#istatcelldata.census2011.download.download_geodata","title":"<code>download_geodata(output_data_folder, census_year, region_list=[])</code>","text":"<p>Download census geodata for one or more regions for a census year.</p> <p>This function retrieves URLs for census geodata packages (ZIP) via <code>get_census_dictionary()</code>, creates the destination folder structure for the census year, and proceeds to download the ZIP files for the requested regions. If <code>region_list</code> is empty, data for all available regions in the dictionary is downloaded (typically 20).</p> PARAMETER DESCRIPTION <code>output_data_folder</code> <p>Root folder where the entire census data structure will be saved.</p> <p> TYPE: <code>Path</code> </p> <code>census_year</code> <p>Reference year for the census (e.g., 1991, 2001, 2011).</p> <p> TYPE: <code>int</code> </p> <code>region_list</code> <p>List of ISTAT region codes for which to download geodata. If empty, geodata for all predefined regions is downloaded.</p> <p> TYPE: <code>list[int]</code> DEFAULT: <code>[]</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path to the folder containing the downloaded census geodata ZIP files.</p> Note <p>The function does not extract the ZIP files: it only downloads them. Geodata URLs are obtained from the census dictionary via the <code>geodata_urls</code> key. The final data path is organized via the global <code>GEODATA_FOLDER</code> constant.</p>"},{"location":"documentation/download/#istatcelldata.census2021.download.download_all_census_data_2021","title":"<code>download_all_census_data_2021(output_data_folder, region_list=[])</code>","text":"<p>Download complete census and geographic dataset for the 2021 Census.</p> <p>This function performs all necessary operations to obtain 2021 census data, automatically coordinating:</p> <ol> <li>Download of tabular census data.</li> <li>Download of geodata for requested regions (or all, if <code>region_list</code> is empty).</li> <li>Download of official administrative boundaries.</li> </ol> <p>The function automatically creates the necessary folder structure to organize the data, defined by the <code>PREPROCESSING_FOLDER</code> constant.</p> PARAMETER DESCRIPTION <code>output_data_folder</code> <p>Main path where 2021 Census data will be saved.</p> <p> TYPE: <code>Path</code> </p> <code>region_list</code> <p>Region codes or names for which to download geodata. If the list is empty, geodata for all regions is downloaded.</p> <p> TYPE: <code>list</code> DEFAULT: <code>[]</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path to the root folder containing the complete downloaded data structure</p> <code>Path</code> <p>for the 2021 Census.</p> Note <p>The <code>census_year</code> parameter is fixed at 2021. It uses support functions: <code>download_data()</code>, <code>download_geodata()</code>, and <code>download_administrative_boundaries()</code>.</p>"},{"location":"documentation/download/#istatcelldata.census2021.download.download_data","title":"<code>download_data(output_data_folder, census_year)</code>","text":"<p>Download, organize, and convert census data to processable format.</p> <p>This function manages the complete workflow of downloading and preparing census data for a specific year. It identifies XLSX files present, performs conversion to CSV, and removes the original files that are no longer needed.</p> PARAMETER DESCRIPTION <code>output_data_folder</code> <p>Path to the main folder where downloaded and processed data will be saved.</p> <p> TYPE: <code>Path</code> </p> <code>census_year</code> <p>Reference year for the census data to download.</p> <p> TYPE: <code>int</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path to the folder containing the downloaded and processed data.</p> RAISES DESCRIPTION <code>Exception</code> <p>If no XLSX file is found in the downloaded data folder.</p> Note <p>XLSX files are converted to CSV to facilitate subsequent ETL and analysis phases. Original XLSX files are deleted to reduce disk space usage. The final data structure depends on the global constants <code>DATA_FOLDER</code> and <code>CENSUS_DATA_FOLDER</code>.</p>"},{"location":"documentation/download/#istatcelldata.executor.download.download_census","title":"<code>download_census(years, output_data_folder, region_list=[])</code>","text":"<p>Download census data for one or more requested years including geodata and boundaries.</p> <p>This function provides centralized download of census data for years 1991, 2001, 2011, and 2021. For each year, it automatically executes the following procedures:</p> <ul> <li>Download of tabular census data</li> <li>Download of geodata (for all regions or specified ones)</li> <li>Download of administrative boundaries</li> </ul> <p>If <code>years</code> is empty, data for all available years is downloaded automatically.</p> PARAMETER DESCRIPTION <code>years</code> <p>List of census years to download. If the list is empty, data for all census years (1991, 2001, 2011, 2021) will be downloaded.</p> <p> TYPE: <code>list[int]</code> </p> <code>output_data_folder</code> <p>Path to the folder where all downloaded data will be saved.</p> <p> TYPE: <code>Path</code> </p> <code>region_list</code> <p>Optional list of region codes or names for which to download geodata. If empty, geodata for all available regions is downloaded.</p> <p> TYPE: <code>list</code> DEFAULT: <code>[]</code> </p> RAISES DESCRIPTION <code>ValueError</code> <p>If one of the specified years is not supported or does not exist in the mapping.</p>"},{"location":"documentation/geodata/","title":"GeoData Module","text":"<p>The Geodata module provides tools for managing and preprocessing geographic data, including administrative boundaries and census data. The functions in this module facilitate reading, filtering, and converting data into formats suitable for geographic analysis, such as GeoDataFrame and GeoPackage.</p>"},{"location":"documentation/geodata/#istatcelldata.geodata.preprocess_geodata","title":"<code>preprocess_geodata(census_shp_folder, census_target_columns, census_tipo_loc_mapping, output_folder, census_layer_name, census_column_remapping=None, regions_file_path=None, regions_target_columns=None, regions_index_column=None, regions_column_remapping=None, provinces_file_path=None, provinces_target_columns=None, provinces_index_column=None, provinces_column_remapping=None, municipalities_file_path=None, municipalities_target_columns=None, municipalities_index_column=None, municipalities_column_remapping=None, municipalities_code=[])</code>","text":"<p>Preprocess census geodata and administrative boundaries and save to GeoPackage.</p> <p>This function executes the complete workflow for preparing geographic data for a census year, combining:</p> <ol> <li>Reading and normalizing administrative boundaries (regions, provinces, municipalities).</li> <li>Optionally correcting missing fields (e.g., <code>COD_PROV</code> for 2021).</li> <li>Reading and preparing census data (sections) from shapefiles.</li> <li>Joining sections with municipalities, provinces, and regions.</li> <li>Optionally filtering for a subset of municipalities (<code>municipalities_code</code>).</li> <li>Saving the final result to a GeoPackage.</li> </ol> PARAMETER DESCRIPTION <code>census_shp_folder</code> <p>Folder containing census shapefiles (sections).</p> <p> TYPE: <code>Path</code> </p> <code>census_target_columns</code> <p>Columns to select from census data (sections).</p> <p> TYPE: <code>list</code> </p> <code>census_tipo_loc_mapping</code> <p>Mapping for the <code>TIPO_LOC</code> field to derive the locality type description.</p> <p> TYPE: <code>dict</code> </p> <code>output_folder</code> <p>Folder where the resulting GeoPackage will be saved.</p> <p> TYPE: <code>Path</code> </p> <code>census_layer_name</code> <p>Name of the census layer (e.g., <code>census2011</code>), also used to derive the year from the suffix.</p> <p> TYPE: <code>str</code> </p> <code>census_column_remapping</code> <p>Optional mapping to rename census data columns.</p> <p> TYPE: <code>dict | None</code> DEFAULT: <code>None</code> </p> <code>regions_file_path</code> <p>Optional path to the regional boundaries vector file.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> <code>regions_target_columns</code> <p>Optional columns to select from regional data.</p> <p> TYPE: <code>list | None</code> DEFAULT: <code>None</code> </p> <code>regions_index_column</code> <p>Optional column to use as index for regional data.</p> <p> TYPE: <code>str | None</code> DEFAULT: <code>None</code> </p> <code>regions_column_remapping</code> <p>Optional mapping to rename regional data columns.</p> <p> TYPE: <code>dict | None</code> DEFAULT: <code>None</code> </p> <code>provinces_file_path</code> <p>Optional path to the provincial boundaries vector file.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> <code>provinces_target_columns</code> <p>Optional columns to select from provincial data.</p> <p> TYPE: <code>list | None</code> DEFAULT: <code>None</code> </p> <code>provinces_index_column</code> <p>Optional column to use as index for provincial data.</p> <p> TYPE: <code>str | None</code> DEFAULT: <code>None</code> </p> <code>provinces_column_remapping</code> <p>Optional mapping to rename provincial data columns.</p> <p> TYPE: <code>dict | None</code> DEFAULT: <code>None</code> </p> <code>municipalities_file_path</code> <p>Optional path to the municipal boundaries vector file.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> <code>municipalities_target_columns</code> <p>Optional columns to select from municipal data.</p> <p> TYPE: <code>list | None</code> DEFAULT: <code>None</code> </p> <code>municipalities_index_column</code> <p>Optional column to use as index for municipal data.</p> <p> TYPE: <code>str | None</code> DEFAULT: <code>None</code> </p> <code>municipalities_column_remapping</code> <p>Optional mapping to rename municipal data columns.</p> <p> TYPE: <code>dict | None</code> DEFAULT: <code>None</code> </p> <code>municipalities_code</code> <p>Optional list of ISTAT municipality codes (<code>PRO_COM</code> field) to extract. If empty, all municipalities are kept.</p> <p> TYPE: <code>list[int]</code> DEFAULT: <code>[]</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path to the generated GeoPackage containing the census layer enriched</p> <code>Path</code> <p>with administrative information.</p> Note <p>The census year is derived from the layer name <code>census_layer_name[6:]</code> (e.g., <code>census2011</code> \u2192 <code>2011</code>). For 2021, the <code>COD_PROV</code> column is manually reconstructed from <code>PRO_COM_T</code> (see repository issue #47). The GeoPackage is saved as <code>{YEAR_GEODATA_NAME}.gpkg</code> and the layer as <code>{YEAR_GEODATA_NAME}{census_year}</code>.</p>"},{"location":"documentation/geodata/#istatcelldata.geodata.read_administrative_boundaries","title":"<code>read_administrative_boundaries(file_path, target_columns, index_column, column_remapping=None, output_folder=None, layer_name=None)</code>","text":"<p>Read administrative boundaries and return a DataFrame or GeoPackage.</p> <p>This function reads an administrative boundary file (typically a shapefile), selects a subset of columns, and sets a column as the index. Depending on the provided parameters, it can:</p> <ul> <li>Return a DataFrame without geometry, sorted and indexed; or</li> <li>Save the data as a layer in a GeoPackage, preserving the geometry.</li> </ul> <p>The encoding is derived from the .dbf file associated with the shapefile to avoid issues with accented characters or special symbols.</p> PARAMETER DESCRIPTION <code>file_path</code> <p>Path to the vector file (e.g., shapefile) containing administrative boundaries.</p> <p> TYPE: <code>Path</code> </p> <code>target_columns</code> <p>List of columns to select from the source dataset. The geometry column is added automatically.</p> <p> TYPE: <code>list</code> </p> <code>index_column</code> <p>Name of the column to use as the DataFrame index (e.g., ISTAT code).</p> <p> TYPE: <code>str</code> </p> <code>column_remapping</code> <p>Optional dictionary to rename columns (e.g., <code>{\"DEN_REG\": \"REGIONE\"}</code>). If None, original names are kept.</p> <p> TYPE: <code>dict | None</code> DEFAULT: <code>None</code> </p> <code>output_folder</code> <p>Optional output folder where the GeoPackage will be saved. If None, the function returns a DataFrame (without geometry) instead of writing to disk.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> <code>layer_name</code> <p>Optional name of the layer to use within the GeoPackage. Must be specified if <code>output_folder</code> is provided, to properly distinguish layers.</p> <p> TYPE: <code>str | None</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <code>DataFrame | Path</code> <p>Either an indexed and sorted DataFrame without geometry column if</p> <code>DataFrame | Path</code> <p><code>output_folder</code> is None, or the path to the created GeoPackage if</p> <code>DataFrame | Path</code> <p><code>output_folder</code> is provided.</p> Note <p>The geometry column is automatically added to <code>target_columns</code> via the <code>GEOMETRY_COLUMN_NAME</code> constant. The GeoPackage is saved with a name based on the <code>YEAR_GEODATA_NAME</code> constant and contains the layer specified by <code>layer_name</code>.</p>"},{"location":"documentation/geodata/#istatcelldata.geodata.read_census","title":"<code>read_census(shp_folder, target_columns, tipo_loc_mapping, column_remapping=None, output_folder=None, layer_name=None)</code>","text":"<p>Read census data from shapefiles and return a GeoDataFrame or GeoPackage.</p> <p>This function recursively searches for all shapefiles in a folder, reads their data, selects a subset of columns, corrects invalid geometries, adds the locality type description (derived from <code>tipo_loc_mapping</code>), and builds a unified GeoDataFrame with all census sections.</p> <p>Depending on the parameters, it can:</p> <ul> <li>Return the resulting GeoDataFrame directly; or</li> <li>Save the data as a layer in a GeoPackage (<code>YEAR_GEODATA_NAME.gpkg</code>) and   return the path to the created file.</li> </ul> PARAMETER DESCRIPTION <code>shp_folder</code> <p>Path to the folder containing census shapefiles (recursive reading via <code>rglob(\"*.shp\")</code>).</p> <p> TYPE: <code>Path</code> </p> <code>target_columns</code> <p>List of columns to select from each shapefile (must include or be compatible with the geometry column).</p> <p> TYPE: <code>list</code> </p> <code>tipo_loc_mapping</code> <p>Mapping of locality codes for the <code>TIPO_LOC</code> field (e.g., <code>{1: \"Centro abitato\", 2: \"Nucleo\", ...}</code>), used to create the descriptive column <code>DEN_LOC</code>.</p> <p> TYPE: <code>dict</code> </p> <code>column_remapping</code> <p>Optional dictionary to rename selected columns (e.g., <code>{\"PRO_COM\": \"PRO_COMUNE\"}</code>). If None, original names are kept.</p> <p> TYPE: <code>dict | None</code> DEFAULT: <code>None</code> </p> <code>output_folder</code> <p>Optional folder where the resulting GeoPackage will be saved. If None, the function does not write to disk and returns the GeoDataFrame directly.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> <code>layer_name</code> <p>Optional name of the layer to use within the GeoPackage. Must be specified if <code>output_folder</code> is provided.</p> <p> TYPE: <code>str | None</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <code>GeoDataFrame | Path</code> <p>Either a <code>GeoDataFrame</code> with census data and corrected geometries if</p> <code>GeoDataFrame | Path</code> <p><code>output_folder</code> is None, or the path to the created GeoPackage if</p> <code>GeoDataFrame | Path</code> <p><code>output_folder</code> is provided.</p> RAISES DESCRIPTION <code>ValueError</code> <p>If no shapefile is found in the specified folder.</p> Note <p>Geometries are validated with <code>make_valid()</code> to reduce issues caused by invalid polygons. An <code>area_mq</code> column containing the area in square meters is calculated. The GeoDataFrame index is set to the first column in <code>df_columns</code> (typically the census section code).</p>"},{"location":"documentation/intro/","title":"Documentation","text":"<p>The developed functions allow managing both census data and geodata in their entirety. You can download data and geodata and then process them.</p>"},{"location":"documentation/intro/#census-cell-data-over-the-years","title":"Census Cell Data Over the Years","text":"<p>Census data differs from year to year not only in content but especially in the data structure used by ISTAT itself.</p> <p>In particular, the years 1991 and 2001 have the same data structure but different from that of the years 2011 and 2021, which are similar to each other.</p> <p>For 2021, there is also a complete change in file nomenclature as well as download URLs for data only.</p>"},{"location":"documentation/intro/#region-code","title":"Region Code","text":"<p>Starting from version <code>0.6.0</code>, it is possible to process data not necessarily for all of Italy but also for one or more regions, as the user chooses. The choice of region(s) to process is made using the code of the region of interest.</p> Code Region 01 Piemonte 02 Valle d'Aosta/Vall\u00e9e d'Aoste 03 Lombardia 04 Trentino-Alto Adige/S\u00fcdtirol 05 Veneto 06 Friuli-Venezia Giulia 07 Liguria 08 Emilia-Romagna 09 Toscana 10 Umbria 11 Marche 12 Lazio 13 Abruzzo 14 Molise 15 Campania 16 Puglia 17 Basilicata 18 Calabria 19 Sicilia 20 Sardegna <p>The source of the previous table is this.</p>"},{"location":"documentation/intro/#shared-data","title":"Shared data","text":"<p>TO BE REVIEWED FOR 2021 DATA</p> <p>Analyzing the trace records of the 1991, 2001, and 2011 censuses revealed the presence of fields that have maintained their code. These fields are defined as <code>SHARED_DATA</code> and can be obtained by discarding those that have changed their code over the years. The shared fields are as follows:</p> <pre><code>SHARED_DATA = {\n    'pop_tot': {\n        'descrizione': 'Resident population - TOTAL',\n        'codice': 'P1'\n    },\n    'pop_tot_m': {\n        'descrizione': 'Resident population - Males',\n        'codice': 'P2'\n    },\n    'pop_tot_f': {\n        'descrizione': 'Resident population - Females',\n        'codice': 'P3'\n    },\n    'pop_meno_5_anni': {\n        'descrizione': 'Resident population - age &lt; 5 years',\n        'codice': 'P14'\n    },\n    'pop_5_9_anni': {\n        'descrizione': 'Resident population - age 5 - 9 years',\n        'codice': 'P15'\n    },\n    'pop_10_14_anni': {\n        'descrizione': 'Resident population - age 10 - 14 years',\n        'codice': 'P16'\n    },\n    'pop_15_19_anni': {\n        'descrizione': 'Resident population - age 15 - 19 years',\n        'codice': 'P17'\n    },\n    'pop_20_24_anni': {\n        'descrizione': 'Resident population - age 20 - 24 years',\n        'codice': 'P18'\n    },\n    'pop_25_29_anni': {\n        'descrizione': 'Resident population - age 25 - 29 years',\n        'codice': 'P19'\n    },\n    'pop_30_34_anni': {\n        'descrizione': 'Resident population - age 30 - 34 years',\n        'codice': 'P20'\n    },\n    'pop_35_39_anni': {\n        'descrizione': 'Resident population - age 35 - 39 years',\n        'codice': 'P21'\n    },\n    'pop_40_44_anni': {\n        'descrizione': 'Resident population - age 40 - 44 years',\n        'codice': 'P22'\n    },\n    'pop_45_49_anni': {\n        'descrizione': 'Resident population - age 45 - 49 years',\n        'codice': 'P23'\n    },\n    'pop_50_54_anni': {\n        'descrizione': 'Resident population - age 50 - 54 years',\n        'codice': 'P24'\n    },\n    'pop_55_59_anni': {\n        'descrizione': 'Resident population - age 55 - 59 years',\n        'codice': 'P25'\n    },\n    'pop_60_64_anni': {\n        'descrizione': 'Resident population - age 60 - 64 years',\n        'codice': 'P26'\n    },\n    'pop_65_69_anni': {\n        'descrizione': 'Resident population - age 65 - 69 years',\n        'codice': 'P27'\n    },\n    'pop_70_74_anni': {\n        'descrizione': 'Resident population - age 70 - 74 years',\n        'codice': 'P28'\n    },\n    'pop_maggiore_74_anni': {\n        'descrizione': 'Resident population - age &gt; 74 years',\n        'codice': 'P29'\n    },\n    'pop_meno_5_anni_m': {\n        'descrizione': 'Resident population - Males - age &lt; 5 years',\n        'codice': 'P30'\n    },\n    'pop_5_9_anni_m': {\n        'descrizione': 'Resident population - Males - age 5 - 9 years',\n        'codice': 'P31'\n    },\n    'pop_10_14_anni_m': {\n        'descrizione': 'Resident population - Males - age 10 - 14 years',\n        'codice': 'P32'\n    },\n    'pop_15_19_anni_m': {\n        'descrizione': 'Resident population - Males - age 15 - 19 years',\n        'codice': 'P33'\n    },\n    'pop_20_24_anni_m': {\n        'descrizione': 'Resident population - Males - age 20 - 24 years',\n        'codice': 'P34'\n    },\n    'pop_25_29_anni_m': {\n        'descrizione': 'Resident population - Males - age 25 - 29 years',\n        'codice': 'P35'\n    },\n    'pop_30_34_anni_m': {\n        'descrizione': 'Resident population - Males - age 30 - 34 years',\n        'codice': 'P36'\n    },\n    'pop_35_39_anni_m': {\n        'descrizione': 'Resident population - Males - age 35 - 39 years',\n        'codice': 'P37'\n    },\n    'pop_40_44_anni_m': {\n        'descrizione': 'Resident population - Males - age 40 - 44 years',\n        'codice': 'P38'\n    },\n    'pop_45_49_anni_m': {\n        'descrizione': 'Resident population - Males - age 45 - 49 years',\n        'codice': 'P39'\n    },\n    'pop_50_54_anni_m': {\n        'descrizione': 'Resident population - Males - age 50 - 54 years',\n        'codice': 'P40'\n    },\n    'pop_55_59_anni_m': {\n        'descrizione': 'Resident population - Males - age 55 - 59 years',\n        'codice': 'P41'\n    },\n    'pop_60_64_anni_m': {\n        'descrizione': 'Resident population - Males - age 60 - 64 years',\n        'codice': 'P42'\n    },\n    'pop_65_69_anni_m': {\n        'descrizione': 'Resident population - Males - age 65 - 69 years',\n        'codice': 'P43'\n    },\n    'pop_70_74_anni_m': {\n        'descrizione': 'Resident population - Males - age 70 - 74 years',\n        'codice': 'P44'\n    },\n    'pop_maggiore_74_anni_m': {\n        'descrizione': 'Resident population - Males - age &gt; 74 years',\n        'codice': 'P45'\n    },\n    'lavoratori_tot': {\n        'descrizione': 'Labor force - TOTAL',\n        'codice': 'P60'\n    },\n    'lavoratori_occupati': {\n        'descrizione': 'Labor force - Employed',\n        'codice': 'P61'\n    },\n    'lavoratori_disoccupati': {\n        'descrizione': 'Labor force - Unemployed and other job seekers',\n        'codice': 'P62'\n    },\n    'famiglie_tot': {\n        'descrizione': 'Total families',\n        'codice': 'PF1'\n    },\n    'famiglie_componenti_tot': {\n        'descrizione': 'Total family members',\n        'codice': 'PF2'\n    },\n    'famiglie_1_componente': {\n        'descrizione': 'Families with 1 member',\n        'codice': 'PF3'\n    },\n    'famiglie_2_componenti': {\n        'descrizione': 'Families with 2 members',\n        'codice': 'PF4'\n    },\n    'famiglie_3_componenti': {\n        'descrizione': 'Families with 3 members',\n        'codice': 'PF5'\n    },\n    'famiglie_4_componenti': {\n        'descrizione': 'Families with 4 members',\n        'codice': 'PF6'\n    },\n    'famiglie_5_componenti': {\n        'descrizione': 'Families with 5 members',\n        'codice': 'PF7'\n    },\n    'famiglie_6_componenti_e_oltre': {\n        'descrizione': 'Families with 6 or more members',\n        'codice': 'PF8'\n    },\n    'famiglie_residenti_oltre_6_componenti': {\n        'descrizione': 'Resident family members of families with 6 or more members',\n        'codice': 'PF9'\n    },\n}\n</code></pre>"},{"location":"documentation/process/","title":"Process and Pre-process Module","text":"<p>The Process and Pre-process module focuses on advanced management and processing of census data, integrating administrative information and combining geographic and tabular data to obtain enriched datasets.</p>"},{"location":"documentation/process/#istatcelldata.executor.process.finalize_census_data","title":"<code>finalize_census_data(census_data_path, years, output_data_folder=None, delete_preprocessed_data=False)</code>","text":"<p>Finalize census data by merging geodata and tabular data into a single GeoPackage.</p> <p>For each specified year, this function: 1. Reads geographic data (census sections) from layer <code>census&lt;year&gt;</code>. 2. Reads tabular data from layer <code>data&lt;year&gt;</code>. 3. Removes unnecessary columns from tabular data. 4. Performs a join between geographic and tabular data on key <code>SEZ&lt;year&gt;</code>. 5. Sorts the data and builds a final GeoDataFrame. 6. Saves the result to a GeoPackage named <code>census_data.gpkg</code>,    with one layer per year (<code>census&lt;year&gt;</code>).</p> PARAMETER DESCRIPTION <code>census_data_path</code> <p>Folder containing the pre-processed GeoPackage file (<code>census.gpkg</code>), generated by previous workflow stages.</p> <p> TYPE: <code>Path</code> </p> <code>years</code> <p>List of census years to finalize (e.g., [1991, 2001, 2011, 2021]).</p> <p> TYPE: <code>list</code> </p> <code>output_data_folder</code> <p>Optional folder where the final GeoPackage <code>census_data.gpkg</code> will be saved. If None, the file is saved in <code>census_data_path</code>.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> <code>delete_preprocessed_data</code> <p>If True, deletes the <code>census.gpkg</code> file after finalization is complete.</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> RAISES DESCRIPTION <code>FileNotFoundError</code> <p>If the main GeoPackage file <code>census.gpkg</code> does not exist in the path specified by <code>census_data_path</code>.</p> <code>KeyError</code> <p>If the join column <code>SEZ&lt;year&gt;</code> is not present in the geographic or tabular data, or if the columns to remove are not defined in <code>census_data[year]['data_columns_to_remove']</code>.</p> Note <p>The join key between geographic and tabular data is dynamic and follows the <code>SEZ&lt;year&gt;</code> convention. Columns to remove from tabular data are defined in <code>census_data[year]['data_columns_to_remove']</code>. The final GeoPackage may contain multiple layers, one per processed year.</p>"},{"location":"documentation/process/#istatcelldata.executor.preprocess.preprocess_census","title":"<code>preprocess_census(processed_data_folder, years, output_data_folder=None, delete_download_folder=False, municipalities_code=[])</code>","text":"<p>Preprocess census data for one or more years, integrating geodata, boundaries, and tables.</p> <p>This function coordinates the entire census preprocessing workflow, executing for each requested year:</p> <ol> <li>Preprocessing of geographic data (shapefiles or similar).</li> <li>Preprocessing of tabular data (CSV).</li> <li>Addition of administrative information (optional).</li> <li>Saving of resulting data into a GeoPackage.</li> <li>Optional deletion of the pre-processed data folder.</li> </ol> <p>Required inputs are read from the <code>census_data</code> configuration dictionary, which defines paths, columns, mappings, and specific settings for each census year.</p> PARAMETER DESCRIPTION <code>processed_data_folder</code> <p>Folder containing pre-downloaded or pre-processed data (geodata, tabular data, administrative boundaries).</p> <p> TYPE: <code>Path</code> </p> <code>years</code> <p>List of census years to process (e.g., [1991, 2001, 2011, 2021]).</p> <p> TYPE: <code>list[int]</code> </p> <code>output_data_folder</code> <p>Optional folder where processed data will be saved (GeoPackage and associated layers). If None, the parent folder of <code>processed_data_folder</code> is used.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> <code>delete_download_folder</code> <p>If True, deletes the <code>processed_data_folder</code> at the end of the process.</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> <code>municipalities_code</code> <p>Optional list of ISTAT municipality codes to filter in the data (<code>PRO_COM</code> key). If empty, all available municipalities are used.</p> <p> TYPE: <code>list[int]</code> DEFAULT: <code>[]</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path to the final folder containing the processed data.</p> RAISES DESCRIPTION <code>KeyError</code> <p>If the <code>census_data</code> dictionary does not contain configuration for a requested year.</p> <code>Exception</code> <p>For any errors during reading, preprocessing, or saving.</p> Note <p>The GeoPackage file is opened and written via <code>sqlite3.connect()</code>. Layers inserted into the GeoPackage follow conventions such as: - <code>sezioni&lt;year&gt;</code> for the geographic layer - <code>data&lt;year&gt;</code> for the tabular dataset - <code>tracciato&lt;year&gt;</code> for the field trace record The <code>municipalities_code</code> parameter is applied during the geodata phase.</p>"},{"location":"documentation/process/#istatcelldata.census1991.process.add_administrative_info","title":"<code>add_administrative_info(census_data, regions_data_path, regions_target_columns, provinces_data_path, provinces_target_columns, municipalities_data_path, municipalities_target_columns)</code>","text":"<p>Enrich census data with administrative information (municipalities, provinces, regions).</p> <p>This function integrates corresponding administrative codes and names into the census data, sourced from three external datasets: regional, provincial, and municipal boundaries.</p> <p>The logical workflow includes: 1. Standardization of census dataset column names. 2. Reading of administrative datasets (regions, provinces, municipalities). 3. Merge of municipalities with provinces. 4. Merge of result with regions. 5. Final join with census dataset on the municipal key (<code>PRO_COM</code>). 6. Cleanup and renaming of final administrative columns.</p> PARAMETER DESCRIPTION <code>census_data</code> <p>Census dataset to which administrative information will be added.</p> <p> TYPE: <code>DataFrame</code> </p> <code>regions_data_path</code> <p>Path to the file containing regional data.</p> <p> TYPE: <code>Path</code> </p> <code>regions_target_columns</code> <p>List of columns to extract from the regional dataset (the first column is used as the index).</p> <p> TYPE: <code>list</code> </p> <code>provinces_data_path</code> <p>Path to the file containing provincial data.</p> <p> TYPE: <code>Path</code> </p> <code>provinces_target_columns</code> <p>List of columns to extract from the provincial dataset (the first column is used as the index).</p> <p> TYPE: <code>list</code> </p> <code>municipalities_data_path</code> <p>Path to the file containing municipal data.</p> <p> TYPE: <code>Path</code> </p> <code>municipalities_target_columns</code> <p>List of columns to extract from the municipal dataset (the first column is used as the index).</p> <p> TYPE: <code>list</code> </p> RETURNS DESCRIPTION <code>DataFrame</code> <p>Census DataFrame enriched with administrative information on municipalities,</p> <code>DataFrame</code> <p>provinces, and regions.</p> Note <p>Administrative codes used for merges are assumed to be: <code>PRO_COM</code> (municipality), <code>COD_PROV</code>/<code>COD_PRO</code> (province), <code>COD_REG</code> (region). The function uses <code>read_administrative_boundaries()</code> to load and filter administrative datasets.</p>"},{"location":"documentation/utils/","title":"Utils Module","text":"<p>The Utils module collects a series of utility functions for file management and conversion, directory creation, and content extraction from compressed archives. These functions are essential to support census and geographic data management processes.</p>"},{"location":"documentation/utils/#istatcelldata.utils.census_folder","title":"<code>census_folder(output_data_folder, year)</code>","text":"<p>Create (if necessary) the folder dedicated to census data for a specific year.</p> <p>This function generates a directory named <code>census_&lt;year&gt;</code> within the <code>output_data_folder</code> and creates it if it doesn't already exist. This folder represents the root of downloaded and processed data for a specific census, maintaining an organized and consistent structure across different years.</p> PARAMETER DESCRIPTION <code>output_data_folder</code> <p>Main folder under which to create the census directory.</p> <p> TYPE: <code>Path</code> </p> <code>year</code> <p>Census year to organize (e.g., 1991, 2001, 2011, 2021).</p> <p> TYPE: <code>int</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Complete path to the created or existing census folder.</p> RAISES DESCRIPTION <code>Exception</code> <p>If the folder cannot be created due to permissions or invalid paths.</p>"},{"location":"documentation/utils/#istatcelldata.utils.check_encoding","title":"<code>check_encoding(data)</code>","text":"<p>Determine file encoding by reading an initial sample.</p> <p>This function opens the file in binary mode, reads the first 100,000 bytes, and uses the <code>chardet</code> library to estimate the text encoding. If <code>chardet</code> identifies the encoding as <code>'ascii'</code>, it is converted to <code>'latin1'</code> to ensure greater compatibility, since many administrative and geographic files may contain extended characters while being formally interpreted as ASCII.</p> PARAMETER DESCRIPTION <code>data</code> <p>Path to the file whose encoding should be determined.</p> <p> TYPE: <code>Path</code> </p> RETURNS DESCRIPTION <code>str</code> <p>The detected encoding. If <code>'ascii'</code> is detected, it is automatically</p> <code>str</code> <p>replaced with <code>'latin1'</code>.</p> Note <p><code>chardet</code> provides a heuristic estimate of encoding and is not infallible. Reading is limited to the first 100,000 bytes to improve performance. <code>'latin1'</code> is a safe choice to avoid errors on files with accented characters or ambiguous encodings typical of ISTAT administrative datasets.</p>"},{"location":"documentation/utils/#istatcelldata.utils.csv_from_excel","title":"<code>csv_from_excel(data, output_path, metadata=False)</code>","text":"<p>Convert an Excel file (.xls) to CSV format.</p> <p>This function reads a legacy Excel file (.xls) using <code>xlrd</code> and converts the content of a sheet to a CSV file. If <code>metadata=True</code>, the sheet named \"Metadati\" is converted; otherwise, the first available sheet is converted, excluding \"Metadati\" if present.</p> <p>The conversion preserves row order and writes all fields using <code>csv.QUOTE_ALL</code> to ensure compatibility and preserve delimiters, strings with spaces, or special characters.</p> PARAMETER DESCRIPTION <code>data</code> <p>Path to the Excel file to convert.</p> <p> TYPE: <code>Path</code> </p> <code>output_path</code> <p>Path where the output CSV file will be saved.</p> <p> TYPE: <code>Path</code> </p> <code>metadata</code> <p>If True, converts the \"Metadati\" sheet. If False, converts the first available sheet excluding \"Metadati\". Defaults to False.</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path to the generated CSV file.</p> RAISES DESCRIPTION <code>FileNotFoundError</code> <p>If the specified Excel file does not exist.</p> <code>XLRDError</code> <p>If the file cannot be read or the requested sheet does not exist.</p> <code>Exception</code> <p>For any other errors during conversion or writing.</p> Note <p>The conversion uses <code>xlrd</code>, so the file must be in <code>.xls</code> format (Excel legacy). <code>.xlsx</code> files are not supported by xlrd. The CSV is saved in UTF-8 encoding. The function uses <code>tqdm</code> to display a progress bar.</p>"},{"location":"documentation/utils/#istatcelldata.utils.get_census_dictionary","title":"<code>get_census_dictionary(census_year, region_list=[])</code>","text":"<p>Generate official ISTAT URLs for census data, geodata, and administrative boundaries.</p> <p>This function dynamically constructs download paths based on the census year and the list of desired regions. It handles structural differences between previous censuses (1991\u20132011) and the 2021 census.</p> PARAMETER DESCRIPTION <code>census_year</code> <p>Census year (1991, 2001, 2011, or 2021).</p> <p> TYPE: <code>int</code> </p> <code>region_list</code> <p>Optional list of regions for which to generate geodata URLs. If empty, uses regions 1\u201320.</p> <p> TYPE: <code>list[int]</code> DEFAULT: <code>[]</code> </p> RETURNS DESCRIPTION <code>dict</code> <p>Dictionary containing the URLs: - <code>data_url</code>: URL for census data - <code>geodata_urls</code>: URLs for territorial bases - <code>admin_boundaries_url</code>: URL for administrative boundaries - <code>census_code</code>: Primary code for joins and identifiers</p> RAISES DESCRIPTION <code>ValueError</code> <p>If the provided year is not supported.</p>"},{"location":"documentation/utils/#istatcelldata.utils.get_region","title":"<code>get_region(region_list=[])</code>","text":"<p>Return the list of regions to use for geodata download.</p> <p>If no list is provided, returns the complete list of 20 Italian regions (codes 1\u201320). Otherwise, returns the provided list.</p> PARAMETER DESCRIPTION <code>region_list</code> <p>Optional list of region codes to use. If empty, returns all regions (1\u201320).</p> <p> TYPE: <code>list[int]</code> DEFAULT: <code>[]</code> </p> RETURNS DESCRIPTION <code>list[int]</code> <p>List of region codes to process.</p>"},{"location":"documentation/utils/#istatcelldata.utils.remove_files","title":"<code>remove_files(files_path)</code>","text":"<p>Remove a list of files from the filesystem.</p> PARAMETER DESCRIPTION <code>files_path</code> <p>List of Path objects to delete.</p> <p> TYPE: <code>list</code> </p> Note <p>Exceptions are not caught: if a file cannot be deleted, the error emerges explicitly (desirable behavior in ETL workflows).</p>"},{"location":"documentation/utils/#istatcelldata.utils.unzip_data","title":"<code>unzip_data(input_data, output_folder)</code>","text":"<p>Decompress a ZIP file into the specified destination folder.</p> <p>This function opens a ZIP archive and extracts its entire content into the specified folder. If the output folder does not exist, it is created automatically. Functions as an internal component of the ISTAT data download workflow.</p> PARAMETER DESCRIPTION <code>input_data</code> <p>Path to the ZIP file to decompress.</p> <p> TYPE: <code>Path</code> </p> <code>output_folder</code> <p>Folder where the archive content will be extracted.</p> <p> TYPE: <code>Path</code> </p> RETURNS DESCRIPTION <code>Path</code> <p>Path to the folder containing the extracted files.</p> RAISES DESCRIPTION <code>FileNotFoundError</code> <p>If the ZIP file does not exist.</p> <code>BadZipFile</code> <p>If the provided file is not a valid ZIP archive.</p> <code>Exception</code> <p>For any error during decompression.</p>"},{"location":"documentation/utils/#istatcelldata.census1991.utils.census_trace","title":"<code>census_trace(file_path, year, output_path=None)</code>","text":"<p>Extract metadata trace record from the \"Metadati\" sheet of an Excel file.</p> <p>This function accesses the sheet named \"Metadati\" in an Excel file related to census data, extracts the fundamental columns (field name and description), and constructs a pandas DataFrame with an index based on the field name. If an output path is provided, the trace record is also saved in CSV format.</p> PARAMETER DESCRIPTION <code>file_path</code> <p>Path to the Excel file from which to extract metadata.</p> <p> TYPE: <code>Path</code> </p> <code>year</code> <p>Reference year for the census, used to generate the output file name.</p> <p> TYPE: <code>int</code> </p> <code>output_path</code> <p>Path to the folder where the trace record CSV will be saved. If None, a DataFrame is returned directly.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <code>DataFrame | Path</code> <p>Path to the generated CSV file if <code>output_path</code> is provided, or a pandas</p> <code>DataFrame | Path</code> <p>DataFrame containing the metadata trace record if <code>output_path</code> is None.</p> RAISES DESCRIPTION <code>FileNotFoundError</code> <p>If the specified Excel file does not exist.</p> <code>XLRDError</code> <p>If an error occurs while opening or reading the Excel file.</p> <code>Exception</code> <p>For any unexpected errors during parsing or saving.</p>"},{"location":"documentation/utils/#istatcelldata.census1991.utils.read_xls","title":"<code>read_xls(file_path, census_code, output_path=None)</code>","text":"<p>Read an Excel file (.xls) and return a DataFrame or save data as CSV.</p> <p>This function opens an Excel file in <code>.xls</code> format, automatically selects the first useful sheet (excluding any sheets named \"Metadati\"), extracts the sheet rows, constructs a pandas DataFrame, and sets as index the column corresponding to the provided census code.</p> <p>If an output path is specified, the DataFrame is saved in CSV format; otherwise, it is returned directly.</p> PARAMETER DESCRIPTION <code>file_path</code> <p>Path to the Excel file to read.</p> <p> TYPE: <code>Path</code> </p> <code>census_code</code> <p>Name of the column to use as the DataFrame index (e.g., ISTAT municipality code).</p> <p> TYPE: <code>str</code> </p> <code>output_path</code> <p>Path to the folder where the resulting CSV will be saved. If None, the DataFrame is returned without saving.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <code>DataFrame | Path</code> <p>A DataFrame containing data read from the Excel file if <code>output_path</code></p> <code>DataFrame | Path</code> <p>is None, or the path to the saved CSV file if <code>output_path</code> is specified.</p> RAISES DESCRIPTION <code>FileNotFoundError</code> <p>If the specified file does not exist.</p> <code>XLRDError</code> <p>If an error occurs while reading the Excel file.</p> <code>Exception</code> <p>For any unexpected error during parsing or saving.</p>"},{"location":"documentation/utils/#istatcelldata.census2021.utils.read_xlsx","title":"<code>read_xlsx(file_path, output_path=None)</code>","text":"<p>Read an Excel file (XLSX format) and convert to a Pandas DataFrame.</p> <p>If specified, saves the data in CSV format.</p> PARAMETER DESCRIPTION <code>file_path</code> <p>Path to the Excel file to read.</p> <p> TYPE: <code>Path</code> </p> <code>output_path</code> <p>Path where the generated CSV file will be saved. If not specified, returns the DataFrame.</p> <p> TYPE: <code>Path | None</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <code>DataFrame | Path</code> <p>A DataFrame if <code>output_path</code> is None, otherwise returns the path to</p> <code>DataFrame | Path</code> <p>the saved CSV file.</p> RAISES DESCRIPTION <code>FileNotFoundError</code> <p>If the specified Excel file is not found.</p> <code>ValueError</code> <p>If the Excel file cannot be read correctly.</p>"},{"location":"tutorial/intro/","title":"Tutorial","text":""},{"location":"tutorial/intro/#raw-data-download","title":"Raw Data Download","text":"<p>How to download raw data. link</p>"},{"location":"tutorial/intro/#raw-data-preprocessing","title":"Raw Data Preprocessing","text":"<p>How to preprocess raw data. Preprocessed data and raw data are stored in the same path. link</p>"},{"location":"tutorial/intro/#data-aggregation","title":"Data Aggregation","text":"<p>How to obtain a single GeoPackage per census year. You can choose to keep or delete the raw and preprocessed data. link</p>"},{"location":"it/","title":"ISTAT Cell Data","text":"<p>Con ISTAT Cell Data puoi ottenere facilmente il set di dati riferiti ai censimenti ISTAT in cui sono stati  rilasciati anche i dati delle celle censuarie.</p> <p>E' possibile scaricare e processare i dati dal 1991 al 2021.</p>"},{"location":"it/#installazione","title":"Installazione","text":"<p><code>pip install istatcelldata</code></p> <p>Info</p> <p>Questo progetto non \u00e8 collegato ad ISTAT n\u00e8 supportato da ISTAT ed \u00e8 una iniziativa autonoma di Massimiliano Moraca.</p> <p>Questo repository \u00e8 stato creato grazie a MkDocs, Material for MkDocs e mkdocstring.</p>"},{"location":"it/LICENSE/","title":"Licenza","text":"<p>MIT License</p> <p>Copyright (c) 2023 Massimiliano Moraca</p> <p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p> <p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p> <p>THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>"},{"location":"it/documentation/data/","title":"Modulo Data","text":"<p>Questo modulo gestisce i dati non geografici.</p>"},{"location":"it/documentation/download/","title":"Modulo Download","text":"<p>Il modulo Download fornisce una serie di funzioni per scaricare e gestire dati censuari ed i confini amministrativi.  Le funzioni principali permettono di scaricare i dati da link specifici, organizzare i file in strutture di cartelle e  gestire il processo di estrazione e cancellazione automatica dei file ZIP.</p>"},{"location":"it/documentation/geodata/","title":"Modulo GeoData","text":"<p>Il modulo Geodata fornisce strumenti per la gestione e il preprocessing dei dati geografici, inclusi confini  amministrativi e dati censuari. Le funzioni di questo modulo facilitano la lettura, il filtraggio e la conversione  dei dati in formati utilizzabili per l'analisi geografica, come GeoDataFrame e GeoPackage.</p>"},{"location":"it/documentation/intro/","title":"Documentazione","text":"<p>Le funzioni sviluppate consentono di gestire sia i dati che i geodati censuari nella loro interezza. \u00c8 possibile infatti effettuare il download del dato e del geodato e successivamente processarlo.</p>"},{"location":"it/documentation/intro/#il-dato-sulle-celle-censuarie-negli-anni","title":"Il dato sulle celle censuarie negli anni","text":"<p>I dati censuari risultano essere differenti tra anno ed anno non solo per il loro contenuto ma anche e soprattutto  per la struttura dati con cui sono stati condivisi da ISTAT stessa.</p> <p>In particolare gli anni 1991 e 2001 risultano avere una struttura dati uguale ma differente rispetto a quella degli  anni 2011 e 2021 che a loro volta sono simili tra loro.</p> <p>Per il 2021 inoltre c'\u00e8 un totale cambio di nomenclatura dei file oltre che di url per il download dei soli dati.</p>"},{"location":"it/documentation/intro/#codice-regione","title":"Codice Regione","text":"<p>A partire dalla versione <code>0.6.0</code> \u00e8 possibile elaborare i dati non per forza di tutta l'Italia ma anche solo di una o pi\u00f9  regioni, l'utente pu\u00f2 scegliere. La scelta della o delle regioni da elaborare va fatta usado il codice della Regione di  interesse.</p> Codice Regione 01 Piemonte 02 Valle d\u2019Aosta/Vall\u00e9e d\u2019Aoste 03 Lombardia 04 Trentino-Alto Adige/S\u00fcdtirol 05 Veneto 06 Friuli-Venezia Giulia 07 Liguria 08 Emilia-Romagna 09 Toscana 10 Umbria 11 Marche 12 Lazio 13 Abruzzo 14 Molise 15 Campania 16 Puglia 17 Basilicata 18 Calabria 19 Sicilia 20 Sardegna <p>La fonte della tabella precedente \u00e8 questa.</p>"},{"location":"it/documentation/intro/#shared-data","title":"Shared data","text":"<p>DA RIVEDERE PER I DATI 2021</p> <p>Analizzando i tracciati dei censimenti 1991, 2001 e 2011 si \u00e8 evidenziata la presenza di campi che hanno mantenuto il loro codice. Questi campi sono stati definiti <code>SHARED_DATA</code> ed \u00e8 possibile ottenerli scartando quelli che negli anni hanno cambiato codice. I campi condivisi sono i seguenti:</p> <pre><code>SHARED_DATA = {\n    'pop_tot': {\n        'descrizione': 'Popolazione residente - TOTALE',\n        'codice': 'P1'\n    },\n    'pop_tot_m': {\n        'descrizione': 'Popolazione residente - Maschi',\n        'codice': 'P2'\n    },\n    'pop_tot_f': {\n        'descrizione': 'Popolazione residente - Femmine',\n        'codice': 'P3'\n    },\n    'pop_meno_5_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 &lt; 5 anni',\n        'codice': 'P14'\n    },\n    'pop_5_9_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 5 - 9 anni',\n        'codice': 'P15'\n    },\n    'pop_10_14_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 10 - 14 anni',\n        'codice': 'P16'\n    },\n    'pop_15_19_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 15 - 19 anni',\n        'codice': 'P17'\n    },\n    'pop_20_24_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 20 - 24 anni',\n        'codice': 'P18'\n    },\n    'pop_25_29_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 25 - 29 anni',\n        'codice': 'P19'\n    },\n    'pop_30_34_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 30 - 34 anni',\n        'codice': 'P20'\n    },\n    'pop_35_39_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 35 - 39 anni',\n        'codice': 'P21'\n    },\n    'pop_40_44_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 40 - 44 anni',\n        'codice': 'P22'\n    },\n    'pop_45_49_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 15 - 19 anni',\n        'codice': 'P23'\n    },\n    'pop_50_54_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 20 - 24 anni',\n        'codice': 'P24'\n    },\n    'pop_55_59_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 25 - 29 anni',\n        'codice': 'P25'\n    },\n    'pop_60_64_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 30 - 34 anni',\n        'codice': 'P26'\n    },\n    'pop_65_69_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 35 - 39 anni',\n        'codice': 'P27'\n    },\n    'pop_70_74_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 40 - 44 anni',\n        'codice': 'P28'\n    },\n    'pop_maggiore_74_anni': {\n        'descrizione': 'Popolazione residente - et\u00e0 &gt; 74 anni',\n        'codice': 'P29'\n    },\n    'pop_meno_5_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 &lt; 5 anni',\n        'codice': 'P30'\n    },\n    'pop_5_9_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 5 - 9 anni',\n        'codice': 'P31'\n    },\n    'pop_10_14_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 10 - 14 anni',\n        'codice': 'P32'\n    },\n    'pop_15_19_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 15 - 19 anni',\n        'codice': 'P33'\n    },\n    'pop_20_24_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 20 - 24 anni',\n        'codice': 'P34'\n    },\n    'pop_25_29_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 25 - 29 anni',\n        'codice': 'P35'\n    },\n    'pop_30_34_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 30 - 34 anni',\n        'codice': 'P36'\n    },\n    'pop_35_39_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 35 - 39 anni',\n        'codice': 'P37'\n    },\n    'pop_40_44_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 40 - 44 anni',\n        'codice': 'P38'\n    },\n    'pop_45_49_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 15 - 19 anni',\n        'codice': 'P39'\n    },\n    'pop_50_54_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 20 - 24 anni',\n        'codice': 'P40'\n    },\n    'pop_55_59_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 25 - 29 anni',\n        'codice': 'P41'\n    },\n    'pop_60_64_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 30 - 34 anni',\n        'codice': 'P42'\n    },\n    'pop_65_69_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 35 - 39 anni',\n        'codice': 'P43'\n    },\n    'pop_70_74_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 40 - 44 anni',\n        'codice': 'P44'\n    },\n    'pop_maggiore_74_anni_m': {\n        'descrizione': 'Popolazione residente - Maschi - et\u00e0 &gt; 74 anni',\n        'codice': 'P45'\n    },\n    'lavoratori_tot': {\n        'descrizione': 'Forze lavoro - TOTALE',\n        'codice': 'P60'\n    },\n    'lavoratori_occupati': {\n        'descrizione': 'Forze lavoro - Occupati',\n        'codice': 'P61'\n    },\n    'lavoratori_disoccupati': {\n        'descrizione': 'Forze lavoro - Disoccupati e altre persone in cerca di occupazione',\n        'codice': 'P62'\n    },\n    'famiglie_tot': {\n        'descrizione': 'Famiglie totale',\n        'codice': 'PF1'\n    },\n    'famiglie_componenti_tot': {\n        'descrizione': 'Totale componenti delle famiglie',\n        'codice': 'PF2'\n    },\n    'famiglie_1_componente': {\n        'descrizione': 'Famiglie 1 componente',\n        'codice': 'PF3'\n    },\n    'famiglie_2_componenti': {\n        'descrizione': 'Famiglie 2 componenti',\n        'codice': 'PF4'\n    },\n    'famiglie_3_componenti': {\n        'descrizione': 'Famiglie 3 componenti',\n        'codice': 'PF5'\n    },\n    'famiglie_4_componenti': {\n        'descrizione': 'Famiglie 4 componenti',\n        'codice': 'PF6'\n    },\n    'famiglie_5_componenti': {\n        'descrizione': 'Famiglie 5 componenti',\n        'codice': 'PF7'\n    },\n    'famiglie_6_componenti_e_oltre': {\n        'descrizione': 'Famiglie 6 e oltre componenti',\n        'codice': 'PF8'\n    },\n    'famiglie_residenti_oltre_6_componenti': {\n        'descrizione': 'Componenti delle famiglie residenti di 6 e oltre componenti',\n        'codice': 'PF9'\n    },\n}\n</code></pre>"},{"location":"it/documentation/process/","title":"Modulo Process e Pre-process","text":"<p>Il modulo Process e Pre-process si concentra sulla gestione avanzata e sull'elaborazione dei dati del censimento,  integrando informazioni amministrative e combinando dati geografici e tabellari per ottenere dataset arricchiti. </p>"},{"location":"it/documentation/utils/","title":"Modulo Utils","text":"<p>Il modulo Utils raccoglie una serie di funzioni di utilit\u00e0 per la gestione e la conversione di file, la creazione di  directory e l'estrazione di contenuti da archivi compressi. Queste funzioni sono fondamentali per supportare i processi  di gestione dei dati censuari e geografici.</p>"},{"location":"it/tutorial/intro/#download-dei-dati-grezzi","title":"Download dei dati grezzi","text":"<p>Viene mostrato come effettuare il download dei dati grezzi. link</p>"},{"location":"it/tutorial/intro/#preprocessamento-dei-dati-grezzi","title":"Preprocessamento dei dati grezzi","text":"<p>Viene mostrato come preprocessare i dati grezzi. Dati preprocessati e dati grezzi sono contenuti nello stesso path. link</p>"},{"location":"it/tutorial/intro/#raggruppamento","title":"Raggruppamento","text":"<p>Viene mostrato come ottenere un unico GeoPackage per anno censuario. E' possibile mantenere i dati grezzi e    preprocessati, oppure eliminarli. link</p>"}]}